; execve-stack-ls-al.nasm
; Author:  Chase hatch

global _start
section .text
_start:


	;  The entire structure that needs to be pushed onto stack is as follows:
	;  [dw addr]  	0x00000000  	//bin/ls  	0x00000000
	;  4		3		2		1
	;  ecx		edx		ebx		

	xor eax, eax
	push eax				;1
	push 0x736c2f6e 	;  sl/n 	;2
	push 0x69622f2f 	;  ib//		;2
	mov ebx, esp				;2
	mov edx, eax		;envp is null
	

	; push 0x6c612d  	; la-
	;         3 2 1 and 4 is implied 00
	push eax
	mov esi, esp
	mov word [esi], 0x612d
	mov byte [esi+2], 0x6c

	
	; esi points to stack where contains args
	; and it's already null-terminated!
	push eax
 	push esi
	push ebx
	mov ecx, esp
	mov al, 0xb
	int 0x80



