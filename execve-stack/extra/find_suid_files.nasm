; find_suid_files.nasm
; Author: Chase Hatch

section .tsxt
global _start
_start:

	xor eax, eax
	push eax		;68	;0x00000000
	push 0x646e6966 	;64	;  dnif 
	push 0x2f6e6962 	;60	;  /nib 
	push 0x2f727375 	;56	;  /rsu 
	push 0x2f2f2f2f 	;52	;  ////
	lea ebx, [esp]
	push eax		;48	;0x00000000
	push 0x9090902f 	;44	;  /
	mov dword [esp+1], eax
	push eax		;40	;0x00000000
	push 0x90909065 	;36	;  e 
	push 0x7079742d 	;32	;  pyt-
	mov dword [esp+5], eax
	push eax		;28	;0x00000000
	push 0x90909066 	;24	;  f
	mov dword [esp+1], eax
	push eax		;20	;0x00000000
	push 0x9090906d 	;16	;  m 
	push 0x7265702d 	;12	;  rep-
	mov dword [esp+5], eax
	push eax		;8	;0x00000000
	push 0x733d752d 	;4	;  s=u-
	push eax		;0	;0x00000000
	lea edx, [esp]

	lea esi, [esp]
	lea edi, [esi+4]
	push edi
	lea edi, [esi+12]
	push edi
	lea edi, [esi+24]
	push edi
	lea edi, [esi+32]
	push edi
	lea edi, [esi+44]
	push edi
	lea edi, [esi+52]
	push edi
	lea ecx, [esp]
	mov al, 0xb
	int 0x80

