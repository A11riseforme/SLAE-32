; execve-stack-ls.nasm
; Author:  Chase hatch

global _start
section .text
_start:


	;  The entire structure that needs to be pushed onto stack is as follows:
	;  [dw addr]  	0x00000000  	//bin/ls  	0x00000000
	;  4		3		2		1
	;  ecx		edx		ebx		

	xor eax, eax				;1
	push eax				;1

	; PUSH //bin/ls
	push 0x736c2f6e 	;  sl/n 	;2
	push 0x69622f2f 	;  ib//		;2
	
	mov ebx, esp				;2->ebx
	push eax				;3
	mov edx, esp				;3->edx
	push ebx				;4
	mov ecx, esp				;4->ecx
	mov al, 0xb
	int 0x80

